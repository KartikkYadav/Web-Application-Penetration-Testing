# Application Programming Interface (API)

## What is an API?

An API (Application Programming Interface) is a structured interface that allows different software systems to communicate with each other through predefined rules and protocols.

APIs abstract internal logic and expose only necessary functionality to external systems.

> Think of an API like a restaurant menu — it lists what you can request without exposing how the kitchen prepares it.

---

## Real-World Analogy

- Client → You placing an order  
- API → The menu (interface)  
- Server → The kitchen (processes request and returns result)

---

## Core Components of an API

### 1. Endpoint

An endpoint is a specific URL representing a resource or action.

Example:

    GET https://api.example.com/users/123
  
- /users → Resource

- /123 → Specific object

### 2. HTTP Methods
    
    Method	      Purpose                	Example
    GET          	Retrieve data          	/products
    POST	        Create new resource	    /users
    PUT          	Update resource        	/users/123
    PATCH	        Partial update	        /users/123
    DELETE	      Remove resource	        /users/123

### 3. Request Structure
A client request may contain:

- Headers (Authorization, Content-Type)
- Query Parameters
- Request Body
- Cookies

Example:

    curl -X POST https://api.example.com/login \
      -H "Content-Type: application/json" \
      -d '{"username":"admin","password":"1234"}'

### 4. Response Structure
A server response includes:
- Status Code
- Headers
- Body (JSON/XML/etc.)

Example:

    {
      "id": 123,
      "name": "John Doe",
      "email": "john@example.com"
    }

### 5. HTTP Status Codes

    Code	      Meaning
    200	        Success
    201	        Created
    204	        No Content
    400	        Bad Request
    401	        Unauthorized
    403	        Forbidden
    404	        Not Found
    429	        Too Many Requests
    500	        Internal Server Error

## Common API Use Cases
### 1. Web Applications
- Fetch external services (Maps, Payments, Authentication)
- SPA frameworks using REST APIs
- AJAX-based dynamic content

### 2. Mobile Applications
- User login
- Push notifications
- Profile retrieval

### 3. Microservices Architecture
- Internal service-to-service communication
- Event-driven workflows

### 4. IoT Systems
- Smart home device communication
- Remote monitoring systems

## Why APIs Are Important

    Benefit                	Description
    Modularity	            Break large systems into independent services
    Code Reuse	            Avoid rebuilding core functionality
    Scalability            	Independent scaling of backend services
    Integration          	  Connect CRM, ERP, payment gateways
    Security              	Controlled access via tokens and scopes
    Ecosystem Growth       Enable third-party developers

## API Authentication Mechanisms

    Method	                Description	S                      ecurity Level
    API Key	                Static key in header or URL      	Low–Medium
    Basic Auth	            Base64 username:password	        Low
    OAuth2	                Token-based with scopes	          High
    JWT	                    Signed JSON token	                High
    mTLS	                  Mutual TLS authentication	        Very High

## API-Based Applications vs Traditional Web Applications

| Aspect          | API-Based                          | Traditional              |
|----------------|-----------------------------------|--------------------------|
| Rendering      | Client-side (React, Vue, Angular) | Server-side (PHP, JSP)   |
| Data Format    | JSON                              | HTML                     |
| Architecture   | Decoupled                         | Monolithic               |
| Scalability    | High                              | Moderate                 |
| State          | Token-based                       | Session-based            |
| Attack Surface | Logic flaws, auth issues          | CSRF, XSS, SQLi          |

---

## API Protocol Types

### REST
- Stateless  
- Resource-based  
- Uses HTTP verbs  
- Typically JSON  

### SOAP
- XML-based  
- Strict schema (WSDL)  
- Enterprise systems  

### GraphQL
- Client defines requested fields  
- Single endpoint  
- Prevents over-fetching  
- Can introduce authorization complexity  

---

## Example Request-Response Flow

### Request

    GET /api/v1/users/42 HTTP/1.1
    Host: api.example.com
    Authorization: Bearer <token>

### Response
    
    {
      "id": 42,
      "name": "Alice",
      "email": "alice@example.com",
      "created_at": "2023-01-15T08:45:00Z"
    }

## API Security Considerations (Important for Pentesters)
Since you are working in penetration testing, here are key API-specific risks:

### 1. Broken Object Level Authorization (BOLA)
Accessing other users' resources by modifying IDs.

Example:

    GET /api/v1/users/43

###  2. Broken Authentication
- Weak JWT validation
- Accepting alg: none
- Long-lived tokens

### 3. Mass Assignment
Overwriting internal fields via JSON body.

### 4. Rate Limiting Issues
Brute-force and enumeration attacks.

### 5. Excessive Data Exposure
Returning sensitive internal fields in JSON.

### 6. Improper CORS Configuration
Allowing arbitrary origins.

### 7. Injection in JSON Parameters
SQLi, NoSQLi, Command Injection.

### Tools for API Testing (Security Perspective)
- Burp Suite
- Postman
- curl
- ffuf
- mitmproxy
- JWT Editor
- Swagger UI (for API discovery)
