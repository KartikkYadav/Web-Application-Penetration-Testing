# JSON Web Tokens (JWT)

**JWT (JSON Web Token)** is a compact, URL-safe token format used to securely transmit claims between two parties. JWTs are commonly used for **authentication and authorization** in modern web applications, APIs, and microservices.

---

## What is a JWT?

JWTs are:

- Stateless  
- Compact  
- Digitally signed (and optionally encrypted)  
- Easy to verify without server-side session storage  

JWTs use:

- **JWS (JSON Web Signature)** for signing  
- **JWE (JSON Web Encryption)** for encryption (less common)

---

## JWT Structure

A JWT consists of **three Base64URL-encoded parts**, separated by dots (`.`):

    Header.Payload.Signature


## Example JWT

    eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9
    eyJpc3MiOiJleGFtcGxlLm9yZyIsImF1ZCI6ImV4YW1wbGUuY29tIiwiaWF0IjoxNzI1OTYyNjY4LCJleHAiOjE3MjU5NjYyNjgsInVzZXJuYW1lIjoiYWRtaW4ifQ
    VihfFUGAtVYKVvOAVPCJiZa231PNOROdOCZodxxZVicdM


## 1. Header

The header contains metadata about the token:

- Token type (`JWT`)
- Signing algorithm (`alg`)

### Decode Header

    echo -n "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9" | base64 --decode

### Decoded Header

    {
      "typ": "JWT",
      "alg": "HS256"
    }

## 2. Payload (Claims)

The payload contains claims about the user and token metadata.

### Claim Types

Registered claims (standard fields)

- iss – issuer

- sub – subject

- aud – audience

- exp – expiration

- iat – issued at

### Public claims
- Publicly defined, collision-resistant claims

### Private claims
- Custom application-specific claims

### Decode Payload

    echo -n "eyJpc3MiOiJleGFtcGxlLm9yZyIsImF1ZCI6ImV4YW1wbGUuY29tIiwiaWF0IjoxNzI1OTYyNjY4LCJleHAiOjE3MjU5NjYyNjgsInVzZXJuYW1lIjoiYWRtaW4ifQ" | base64 --decode

### Decoded Payload

    {
      "iss": "example.org",
      "aud": "example.com",
      "iat": 1725962668,
      "exp": 1725966268,
      "username": "admin"
    }

⚠️ Important: JWT payloads are encoded, not encrypted. Anyone with the token can read the payload.

## 3. Signature
The signature ensures:

- Token integrity
- Token authenticity

### Signature Creation

    HMACSHA256(
      base64UrlEncode(header) + "." + base64UrlEncode(payload),
      secret
### Why the signature matters

- Prevents tampering
- Proves the token was issued by a trusted party

⚠️ The signature is cryptographic data and cannot be meaningfully decoded like the header or payload.

### JWT Signature Verification
When a server receives a JWT:

1. Extracts the header and payload
2. Recomputes the signature using the expected key
3. Compares it with the received signature
4. If they match → token is valid

If verification fails → token is rejected

### JWT Signing Algorithms
#### HMAC (HS*)

- Symmetric key
- Same secret used to sign and verify
- Common algorithm: HS256
- Risk: Secret disclosure allows full token forgery

#### RSA (RS*)

- Asymmetric cryptography
- Private key → signing
- Public key → verification
- Common algorithm: RS256
- Preferred for distributed systems

#### ECDSA (ES*)

- Elliptic Curve Cryptography
- Smaller keys, strong security
- Common algorithm: ES256

#### RSASSA-PSS (PS*)

- RSA variant with probabilistic padding
- More resistant to cryptographic attacks
- Example: PS256

#### none Algorithm

- No signature verification
- Extremely insecure
- Must never be enabled

### Choosing the Right Algorithm

- Use HS256 only when secrets are securely managed
- Prefer RS256 or ES256 for production systems
- Never accept alg: none
- Enforce strict algorithm whitelisting

### JWT Security Considerations

- JWT ≠ encrypted token
- Do not store sensitive data in payload
- Always validate:
      - Signature
      - Expiration (exp)
      - Issuer (iss)
      - Audience (aud)
- Rotate signing keys regularly
- Use short expiration times

### JWT Editor (Burp Suite)
JWT Editor is a Burp Suite extension used for JWT testing:

- Decode / modify JWTs
- Sign and re-sign tokens
- Encrypt / decrypt JWTs
- Test JWT-based authentication flaws

### Extension:
https://portswigger.net/bappstore/26aaa5ded2f4beea19e2ed8345a93dd

## Attacking JWT – Weak Secret (HS256)
If a weak secret is used, attackers can brute-force it.

## Brute-force JWT Secret

    hashcat -m 16500 -a 0 jwt.txt /opt/jwt.secrets.list

### Impact
- Modify claims (e.g. role=admin)
- Re-sign valid tokens
- Authentication bypass

### Key Takeaways
- JWTs are signed, not encrypted by default
- Weak secrets break JWT security
- Algorithm confusion is dangerous
