# üìö SQL Notes

## üìå HAVING Clause

- Used to **filter groups** (after `GROUP BY`), similar to how `WHERE` filters rows.

### üî∑ Examples of HAVING

          SELECT gender, COUNT(gender) FROM users GROUP BY gender;

-  ‚úÖ Groups the users table by gender and counts how many users exist for each gender.

          SELECT gender, COUNT(gender) FROM users GROUP BY gender HAVING gender = "M";

-  ‚úÖ Same as above but uses HAVING to only include groups where gender = 'M'.

-  ‚ÑπÔ∏è Note: Since gender is grouped, HAVING acts like WHERE on aggregated data.

          SELECT city_name FROM users;

-  ‚úÖ Lists all city_name values from users. May include duplicates.

           SELECT city_name FROM users GROUP BY city_name;

-  ‚úÖ Lists unique city_name values (similar to using DISTINCT).

           COUNT(city_name) FROM users GROUP BY city_name HAVING city_name = 2;

-  ‚ùå Invalid: You can't use HAVING directly on a column value like that.

-  ‚úÖ Correct Version

            SELECT city_name, COUNT(city_name) 
            FROM users 
            GROUP BY city_name 
            HAVING COUNT(city_name) = 2;
            Filters groups where the count of city_name is 2.

## üìå SUBQUERY
   A query inside another query, usually in the WHERE, FROM, or SELECT clause.

### üî∑ Examples of SUBQUERY

            SELECT * FROM users WHERE course_name = 2;

-  ‚úÖ Finds users where course_name = 2 (assumes it's stored as an ID).

           SELECT * FROM course;

-  ‚úÖ Lists all records from the course table.

           SELECT * FROM users WHERE course_name = "Information Security Expert";

-  ‚ö†Ô∏è May be invalid if course_name stores IDs instead of names.

           SELECT * FROM users 
           WHERE course_name = (
           SELECT course_id FROM course 
           WHERE course_name = "Information Security Expert"
           );

-  ‚úÖ Subquery:

          Gets course_id for "Information Security Expert".

Then fetches users enrolled in that course.

          SELECT * FROM users 
          WHERE city_name = (
          SELECT city_id FROM city 
          WHERE city_name = "Indore"
          );

-  ‚úÖ Gets users where their city_name (as ID) matches the city_id for "Indore".

## üìå UNION vs UNION ALL
   UNION ‚Üí Combines results of two queries, removes duplicates.

   UNION ALL ‚Üí Combines results of two queries, keeps duplicates.

##3 ‚úÖ Requirements:
   Same number of columns.

  Compatible data types.

### üî∑ Examples of UNION

          SELECT * FROM users UNION SELECT * FROM course;

### ‚ùå Invalid: Different column counts.

ERROR 1222 (21000): The used SELECT statements have a different number of columns

          SELECT * FROM city UNION SELECT * FROM course;

### ‚ùå Likely invalid ‚Äî column mismatch.

          SELECT id, name FROM users UNION SELECT * FROM course;

### ‚ùå Invalid: 2 columns vs many columns.

          SELECT id, name FROM users UNION SELECT * FROM city;

#### ‚ùå Same mismatch issue.

          SELECT name FROM users UNION SELECT city_name FROM city;

### ‚úÖ Valid: Single columns of similar type.

Merges and removes duplicates.

          SELECT city_id FROM city UNION SELECT course_id FROM course;

### ‚úÖ Valid: Same data type (IDs), removes duplicates.

          SELECT city_id FROM city UNION ALL SELECT course_id FROM course;

### ‚úÖ Same as above but includes duplicates.
