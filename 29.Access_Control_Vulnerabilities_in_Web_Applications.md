# Access Control Vulnerabilities in Web Applications

Access control in web applications ensures that users can only access resources and perform actions that match their assigned permissions. When access control is improperly implemented or broken, it can lead to serious security risks, including unauthorized data access and full system compromise.

---

## Broken Access Control

Broken access control occurs when restrictions on what authenticated users are allowed to do are not properly enforced.

---

## Insecure Direct Object References (IDOR)

IDOR vulnerabilities arise when applications expose internal object references (such as account numbers or transaction IDs) and fail to verify whether the user is authorized to access them.

### Example
- An attacker modifies an account ID in the URL or request parameter  
- This allows access to another user's bank account details

---

## Privilege Escalation

Privilege escalation allows attackers to gain higher-level permissions than intended.

### Vertical Privilege Escalation
A low-privileged user gains access to high-privileged functionality.

**Example:**  
- A normal user gaining admin rights

### Horizontal Privilege Escalation
A user accesses or modifies another user's data at the same privilege level.

**Example:**  
- Viewing or editing another customer's profile

---

## Comparison: Broken Access Control vs. Privilege Escalation

| Aspect | Broken Access Control | Privilege Escalation |
|------|----------------------|---------------------|
| Nature | Vulnerability category | Attack technique / outcome |
| Scope | Broad | Narrow |
| Root Cause | Missing or flawed authorization checks | Broken access control |
| Can Occur Without Authentication? | Yes (in some cases) | No |
| Requires User Account? | Not always | Yes |
| Includes IDOR? | Yes | Yes (horizontal privilege escalation) |
| Affects Authorization Layer? | Yes | Yes |
| Typical Impact | Unauthorized access to data or functionality | Full or partial takeover of higher-privileged functions |
| Common Attack Methods | IDOR, forced browsing, parameter tampering | Role manipulation, access to admin endpoints |
| Detection During Testing | Authorization bypass checks | Role-based access testing |
| Ease of Exploitation | Often easy | Medium to high (depends on access control weakness) |
| OWASP Category | A01: Broken Access Control | Subset of A01: Broken Access Control |

---

## Missing Function-Level Access Control

This vulnerability occurs when access to sensitive functions is not properly restricted on the server side.

### Key Issues
- Administrative functions are accessible without proper authorization checks  
- Attackers discover hidden functionality by guessing URLs or inspecting requests  

### Example

    /admin/dashboard

## Forced Browsing

Forced browsing involves manually guessing or enumerating URLs to access restricted resources.

### Example
- An application contains an admin page `/admin`
- Access control is not enforced
- Any user can type the URL and gain access

---

## Parameter Tampering

Attackers manipulate request parameters to bypass access control.

### Examples
- Changing `role=user` to `role=admin`
- Modifying account or transaction identifiers

---

## Client-Side Access Control

Access control enforced only via JavaScript or UI logic.

---

## Business Logic Vulnerabilities

Business logic defines how an application operates and enforces workflows. Flaws in business logic can lead to severe consequences such as financial fraud or unauthorized access.

### Impact
- Unauthorized actions  
- Abuse of workflows  
- Financial loss or data exposure  

---

## Failure to Enforce Business Logic Access Control

Occurs when the application fails to enforce authorization checks aligned with business rules.

### Examples
- Users applying discounts they are not eligible for  
- Skipping approval steps in workflows  
- Accessing sensitive data by bypassing intended processes  

---

## Summary

Broken access control remains one of the most critical web application security risks. Proper server-side authorization checks, secure design of business logic, and regular security testing are essential to prevent these vulnerabilities.

# Insecure Direct Object References (IDOR)

Insecure Direct Object References (IDOR) are a type of **access control vulnerability** that occur when an application uses **user-supplied input** to directly access internal objects (such as database records, files, or resources) **without proper authorization checks**.

The term **IDOR** was popularized through its inclusion in the OWASP Top 10 (2007). While widely used today, IDOR is not a standalone vulnerability class â€” it is a **specific instance of broken access control** caused by flawed authorization logic.

## How IDOR Works

An application exposes a reference to an internal object, such as:

- User IDs
- Order numbers
- File names
- Account numbers

If the application **fails to verify** whether the authenticated user is authorized to access the requested object, an attacker can manipulate the reference to access unauthorized data.

### Example

    GET /api/user/profile?id=1001

If changing the ID to 1002 returns another user's profile, the application is vulnerable to IDOR.

## Types of Privilege Escalation Involved

### 1. Horizontal Privilege Escalation

- Accessing another user's resources with the same privilege level

- Most common form of IDOR

### Example:
User A accesses User Bâ€™s account data by modifying an ID parameter.

### 2. Vertical Privilege Escalation

- Accessing higher-privileged resources (e.g., admin-only data)

- Less common, but still possible

### Example:
A normal user accesses /admin/report?id=1 due to missing role checks.

### Commonly Affected Components

- REST APIs

- File downloads

- Object-based URLs

- Mobile application backends

- GraphQL queries

- Cloud storage object references

### Root Cause

- Missing authorization checks

- Reliance on client-side validation

- Predictable or sequential object identifiers

- Confusing authentication with authorization

### Prevention Techniques

- Enforce server-side authorization checks for every object access

- Use indirect object references (e.g., UUIDs, tokens)

- Apply role-based and ownership-based access control

- Avoid exposing internal identifiers

- Log and monitor unauthorized access attempts

### Testing for IDOR

- Modify object identifiers and observe responses

- Test both authenticated and unauthenticated access

- Check APIs, not just UI endpoints

- Verify access across different user roles

# Business Logic Vulnerabilities

Business Logic Vulnerabilities arise when an applicationâ€™s intended workflows, rules, or processes can be **abused or bypassed** due to flawed assumptions in the applicationâ€™s design or implementation. Unlike technical vulnerabilities, these issues exploit **legitimate functionality** used in unintended ways.

Business logic flaws are often **application-specific**, making them difficult to detect using automated tools and more likely to be discovered through **manual testing and threat modeling**.

## Key Characteristics

- **Exploit intended functionality**
- Do not rely on broken authentication or authorization
- Are highly context-dependent
- Often missed by automated scanners
- Can lead to severe financial or data integrity impact

## Common Examples of Business Logic Vulnerabilities

### 1. Workflow Bypass
Skipping required steps in a process.

**Example:**
- Completing a purchase without making a payment
- Accessing a success page directly

### 2. Price / Quantity Manipulation
Altering values sent by the client.

**Example:**

    {
      "price": 1,
      "quantity": -10
    }

### 3. Abuse of Application Features
Using features in a way not intended by the business.

### Example:

- Reusing discount codes multiple times

- Creating unlimited trial accounts

### 4. Race Conditions
Exploiting timing issues.

### Example:

- Double spending

- Redeeming the same coupon multiple times simultaneously

### 5. Missing State Validation
The application fails to track or validate user state.

### Example:

- Password reset without verifying token usage

- Order cancellation after shipment

### 6. Trusting Client-Side Controls
Critical logic enforced only in frontend code.

### Example:

- JavaScript-only checks for eligibility

- Hidden form fields controlling permissions

### Impact

- Financial loss ðŸ’¸

- Unauthorized access or actions

- Data integrity compromise

- Reputation damage

- Regulatory and compliance violations

### Root Causes

- Incorrect assumptions about user behavior

- Lack of threat modeling

- Over-trusting client input

- Incomplete validation of workflow states

- Poor separation between business and security logic

### How to Identify Business Logic Flaws

### Manual Testing Techniques

- Try actions out of order

- Repeat actions multiple times

- Modify request parameters

- Perform actions in parallel

- Test edge cases (negative values, large numbers)

### Key Questions to Ask

- What happens if I skip this step?

- Can I repeat this action?

- Can I do this faster than expected?

- Can I do this without proper preconditions?

## Prevention & Mitigation

- Implement **server-side validation**
- Enforce state transitions
- Use idempotency controls
- Apply rate limiting
- Conduct threat modeling
- Add **business rule validation checks**
- Log and monitor abnormal behavior

## Business Logic vs Technical Vulnerabilities

| Aspect | Business Logic Vulnerabilities | Technical Vulnerabilities |
| :--- | :--- | :--- |
| **Nature** | Design flaw | Implementation flaw |
| **Automation** | Hard to automate | Easily detectable |
| **Context** | Business-specific | Generic |
| **Exploitation** | Legitimate functionality | Broken security control |

## OWASP Mapping

- **OWASP Top 10 (2021):**
    - A04 â€“ Insecure Design
